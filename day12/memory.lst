     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_load_eflags
     7 00000000                                 	EXTERN	_io_store_eflags
     8 00000000                                 	EXTERN	_memtest_sub
     9 00000000                                 	EXTERN	_load_cr0
    10 00000000                                 	EXTERN	_store_cr0
    11 00000000                                 [FILE "memory.c"]
    12                                          [SECTION .text]
    13 00000000                                 	GLOBAL	_memtest
    14 00000000                                 _memtest:
    15 00000000 55                              	PUSH	EBP
    16 00000001 89 E5                           	MOV	EBP,ESP
    17 00000003 57                              	PUSH	EDI
    18 00000004 56                              	PUSH	ESI
    19 00000005 53                              	PUSH	EBX
    20 00000006 31 DB                           	XOR	EBX,EBX
    21 00000008 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
    22 0000000B 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
    23 0000000E E8 [00000000]                   	CALL	_io_load_eflags
    24 00000013 0D 00040000                     	OR	EAX,262144
    25 00000018 50                              	PUSH	EAX
    26 00000019 E8 [00000000]                   	CALL	_io_store_eflags
    27 0000001E E8 [00000000]                   	CALL	_io_load_eflags
    28 00000023 59                              	POP	ECX
    29 00000024 A9 00040000                     	TEST	EAX,262144
    30 00000029 74 02                           	JE	L2
    31 0000002B B3 01                           	MOV	BL,1
    32 0000002D                                 L2:
    33 0000002D 25 FFFBFFFF                     	AND	EAX,-262145
    34 00000032 50                              	PUSH	EAX
    35 00000033 E8 [00000000]                   	CALL	_io_store_eflags
    36 00000038 84 DB                           	TEST	BL,BL
    37 0000003A 5A                              	POP	EDX
    38 0000003B 75 12                           	JNE	L4
    39 0000003D                                 L3:
    40 0000003D 89 75 0C                        	MOV	DWORD [12+EBP],ESI
    41 00000040 89 7D 08                        	MOV	DWORD [8+EBP],EDI
    42 00000043 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    43 00000046 5B                              	POP	EBX
    44 00000047 5E                              	POP	ESI
    45 00000048 5F                              	POP	EDI
    46 00000049 5D                              	POP	EBP
    47 0000004A E9 [00000000]                   	JMP	_memtest_sub
    48 0000004F                                 L4:
    49 0000004F E8 [00000000]                   	CALL	_load_cr0
    50 00000054 0D 60000000                     	OR	EAX,1610612736
    51 00000059 50                              	PUSH	EAX
    52 0000005A E8 [00000000]                   	CALL	_store_cr0
    53 0000005F 58                              	POP	EAX
    54 00000060 EB DB                           	JMP	L3
    55 00000062                                 	GLOBAL	_memman_init
    56 00000062                                 _memman_init:
    57 00000062 55                              	PUSH	EBP
    58 00000063 89 E5                           	MOV	EBP,ESP
    59 00000065 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    60 00000068 C7 00 00000000                  	MOV	DWORD [EAX],0
    61 0000006E C7 40 04 00000000               	MOV	DWORD [4+EAX],0
    62 00000075 C7 40 08 00000000               	MOV	DWORD [8+EAX],0
    63 0000007C C7 40 0C 00000000               	MOV	DWORD [12+EAX],0
    64 00000083 5D                              	POP	EBP
    65 00000084 C3                              	RET
    66 00000085                                 	GLOBAL	_memman_total
    67 00000085                                 _memman_total:
    68 00000085 55                              	PUSH	EBP
    69 00000086 31 C0                           	XOR	EAX,EAX
    70 00000088 89 E5                           	MOV	EBP,ESP
    71 0000008A 31 D2                           	XOR	EDX,EDX
    72 0000008C 53                              	PUSH	EBX
    73 0000008D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    74 00000090 8B 0B                           	MOV	ECX,DWORD [EBX]
    75 00000092 39 C8                           	CMP	EAX,ECX
    76 00000094 73 09                           	JAE	L13
    77 00000096                                 L11:
    78 00000096 03 44 D3 14                     	ADD	EAX,DWORD [20+EBX+EDX*8]
    79 0000009A 42                              	INC	EDX
    80 0000009B 39 CA                           	CMP	EDX,ECX
    81 0000009D 72 F7                           	JB	L11
    82 0000009F                                 L13:
    83 0000009F 5B                              	POP	EBX
    84 000000A0 5D                              	POP	EBP
    85 000000A1 C3                              	RET
    86 000000A2                                 	GLOBAL	_memman_alloc
    87 000000A2                                 _memman_alloc:
    88 000000A2 55                              	PUSH	EBP
    89 000000A3 89 E5                           	MOV	EBP,ESP
    90 000000A5 57                              	PUSH	EDI
    91 000000A6 56                              	PUSH	ESI
    92 000000A7 53                              	PUSH	EBX
    93 000000A8 31 DB                           	XOR	EBX,EBX
    94 000000AA 56                              	PUSH	ESI
    95 000000AB 8B 4D 08                        	MOV	ECX,DWORD [8+EBP]
    96 000000AE 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
    97 000000B1 8B 39                           	MOV	EDI,DWORD [ECX]
    98 000000B3 39 FB                           	CMP	EBX,EDI
    99 000000B5 73 40                           	JAE	L14
   100 000000B7 8B 51 14                        	MOV	EDX,DWORD [20+ECX]
   101 000000BA 39 F2                           	CMP	EDX,ESI
   102 000000BC 72 3F                           	JB	L19
   103 000000BE 8B 41 10                        	MOV	EAX,DWORD [16+ECX]
   104 000000C1 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   105 000000C4 01 F0                           	ADD	EAX,ESI
   106 000000C6 89 41 10                        	MOV	DWORD [16+ECX],EAX
   107 000000C9 89 D0                           	MOV	EAX,EDX
   108 000000CB 29 F0                           	SUB	EAX,ESI
   109 000000CD 89 41 14                        	MOV	DWORD [20+ECX],EAX
   110 000000D0 85 C0                           	TEST	EAX,EAX
   111 000000D2 75 20                           	JNE	L20
   112 000000D4 8D 47 FF                        	LEA	EAX,DWORD [-1+EDI]
   113 000000D7 89 01                           	MOV	DWORD [ECX],EAX
   114 000000D9 39 C3                           	CMP	EBX,EAX
   115 000000DB 73 17                           	JAE	L20
   116 000000DD 89 C6                           	MOV	ESI,EAX
   117 000000DF                                 L25:
   118 000000DF 8B 44 D9 18                     	MOV	EAX,DWORD [24+ECX+EBX*8]
   119 000000E3 8B 54 D9 1C                     	MOV	EDX,DWORD [28+ECX+EBX*8]
   120 000000E7 89 44 D9 10                     	MOV	DWORD [16+ECX+EBX*8],EAX
   121 000000EB 89 54 D9 14                     	MOV	DWORD [20+ECX+EBX*8],EDX
   122 000000EF 43                              	INC	EBX
   123 000000F0 39 F3                           	CMP	EBX,ESI
   124 000000F2 72 EB                           	JB	L25
   125 000000F4                                 L20:
   126 000000F4 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   127 000000F7                                 L14:
   128 000000F7 5B                              	POP	EBX
   129 000000F8 5B                              	POP	EBX
   130 000000F9 5E                              	POP	ESI
   131 000000FA 5F                              	POP	EDI
   132 000000FB 5D                              	POP	EBP
   133 000000FC C3                              	RET
   134 000000FD                                 L19:
   135 000000FD 31 C0                           	XOR	EAX,EAX
   136 000000FF EB F6                           	JMP	L14
   137 00000101                                 	GLOBAL	_memman_free
   138 00000101                                 _memman_free:
   139 00000101 55                              	PUSH	EBP
   140 00000102 89 E5                           	MOV	EBP,ESP
   141 00000104 57                              	PUSH	EDI
   142 00000105 56                              	PUSH	ESI
   143 00000106 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   144 00000109 53                              	PUSH	EBX
   145 0000010A 31 DB                           	XOR	EBX,EBX
   146 0000010C 8B 3E                           	MOV	EDI,DWORD [ESI]
   147 0000010E 39 FB                           	CMP	EBX,EDI
   148 00000110 7D 0E                           	JGE	L32
   149 00000112                                 L36:
   150 00000112 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   151 00000115 39 44 DE 10                     	CMP	DWORD [16+ESI+EBX*8],EAX
   152 00000119 77 05                           	JA	L32
   153 0000011B 43                              	INC	EBX
   154 0000011C 39 FB                           	CMP	EBX,EDI
   155 0000011E 7C F2                           	JL	L36
   156 00000120                                 L32:
   157 00000120 85 DB                           	TEST	EBX,EBX
   158 00000122 7E 0F                           	JLE	L37
   159 00000124 8B 54 DE 0C                     	MOV	EDX,DWORD [12+ESI+EBX*8]
   160 00000128 8B 44 DE 08                     	MOV	EAX,DWORD [8+ESI+EBX*8]
   161 0000012C 01 D0                           	ADD	EAX,EDX
   162 0000012E 3B 45 0C                        	CMP	EAX,DWORD [12+EBP]
   163 00000131 74 73                           	JE	L60
   164 00000133                                 L37:
   165 00000133 39 FB                           	CMP	EBX,EDI
   166 00000135 7D 0C                           	JGE	L46
   167 00000137 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   168 0000013A 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   169 0000013D 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   170 00000141 74 53                           	JE	L61
   171 00000143                                 L46:
   172 00000143 81 FF 00000FF9                  	CMP	EDI,4089
   173 00000149 7F 3D                           	JG	L48
   174 0000014B 89 F9                           	MOV	ECX,EDI
   175 0000014D 39 DF                           	CMP	EDI,EBX
   176 0000014F 7E 15                           	JLE	L58
   177 00000151                                 L53:
   178 00000151 8B 44 CE 08                     	MOV	EAX,DWORD [8+ESI+ECX*8]
   179 00000155 8B 54 CE 0C                     	MOV	EDX,DWORD [12+ESI+ECX*8]
   180 00000159 89 44 CE 10                     	MOV	DWORD [16+ESI+ECX*8],EAX
   181 0000015D 89 54 CE 14                     	MOV	DWORD [20+ESI+ECX*8],EDX
   182 00000161 49                              	DEC	ECX
   183 00000162 39 D9                           	CMP	ECX,EBX
   184 00000164 7F EB                           	JG	L53
   185 00000166                                 L58:
   186 00000166 8D 47 01                        	LEA	EAX,DWORD [1+EDI]
   187 00000169 89 06                           	MOV	DWORD [ESI],EAX
   188 0000016B 39 46 04                        	CMP	DWORD [4+ESI],EAX
   189 0000016E 7D 03                           	JGE	L54
   190 00000170 89 46 04                        	MOV	DWORD [4+ESI],EAX
   191 00000173                                 L54:
   192 00000173 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   193 00000176 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   194 0000017A 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   195 0000017D 89 44 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EAX
   196 00000181                                 L59:
   197 00000181 31 C0                           	XOR	EAX,EAX
   198 00000183                                 L30:
   199 00000183 5B                              	POP	EBX
   200 00000184 5E                              	POP	ESI
   201 00000185 5F                              	POP	EDI
   202 00000186 5D                              	POP	EBP
   203 00000187 C3                              	RET
   204 00000188                                 L48:
   205 00000188 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   206 0000018B FF 46 0C                        	INC	DWORD [12+ESI]
   207 0000018E 01 46 08                        	ADD	DWORD [8+ESI],EAX
   208 00000191 83 C8 FF                        	OR	EAX,-1
   209 00000194 EB ED                           	JMP	L30
   210 00000196                                 L61:
   211 00000196 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   212 00000199 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   213 0000019D 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   214 000001A0 01 44 DE 14                     	ADD	DWORD [20+ESI+EBX*8],EAX
   215 000001A4 EB DB                           	JMP	L59
   216 000001A6                                 L60:
   217 000001A6 03 55 10                        	ADD	EDX,DWORD [16+EBP]
   218 000001A9 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   219 000001AD 3B 1E                           	CMP	EBX,DWORD [ESI]
   220 000001AF 7D D0                           	JGE	L59
   221 000001B1 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   222 000001B4 03 45 10                        	ADD	EAX,DWORD [16+EBP]
   223 000001B7 3B 44 DE 10                     	CMP	EAX,DWORD [16+ESI+EBX*8]
   224 000001BB 75 C4                           	JNE	L59
   225 000001BD 03 54 DE 14                     	ADD	EDX,DWORD [20+ESI+EBX*8]
   226 000001C1 89 54 DE 0C                     	MOV	DWORD [12+ESI+EBX*8],EDX
   227 000001C5 8B 06                           	MOV	EAX,DWORD [ESI]
   228 000001C7 48                              	DEC	EAX
   229 000001C8 89 06                           	MOV	DWORD [ESI],EAX
   230 000001CA 39 C3                           	CMP	EBX,EAX
   231 000001CC 7D B3                           	JGE	L59
   232 000001CE 89 C1                           	MOV	ECX,EAX
   233 000001D0                                 L45:
   234 000001D0 8B 44 DE 18                     	MOV	EAX,DWORD [24+ESI+EBX*8]
   235 000001D4 8B 54 DE 1C                     	MOV	EDX,DWORD [28+ESI+EBX*8]
   236 000001D8 89 44 DE 10                     	MOV	DWORD [16+ESI+EBX*8],EAX
   237 000001DC 89 54 DE 14                     	MOV	DWORD [20+ESI+EBX*8],EDX
   238 000001E0 43                              	INC	EBX
   239 000001E1 39 CB                           	CMP	EBX,ECX
   240 000001E3 7C EB                           	JL	L45
   241 000001E5 EB 9A                           	JMP	L59
   242 000001E7                                 	GLOBAL	_memman_alloc_4k
   243 000001E7                                 _memman_alloc_4k:
   244 000001E7 55                              	PUSH	EBP
   245 000001E8 89 E5                           	MOV	EBP,ESP
   246 000001EA 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   247 000001ED 05 00000FFF                     	ADD	EAX,4095
   248 000001F2 25 FFFFF000                     	AND	EAX,-4096
   249 000001F7 89 45 0C                        	MOV	DWORD [12+EBP],EAX
   250 000001FA 5D                              	POP	EBP
   251 000001FB E9 FFFFFEA2                     	JMP	_memman_alloc
   252 00000200                                 	GLOBAL	_memman_free_4k
   253 00000200                                 _memman_free_4k:
   254 00000200 55                              	PUSH	EBP
   255 00000201 89 E5                           	MOV	EBP,ESP
   256 00000203 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   257 00000206 05 00000FFF                     	ADD	EAX,4095
   258 0000020B 25 FFFFF000                     	AND	EAX,-4096
   259 00000210 89 45 10                        	MOV	DWORD [16+EBP],EAX
   260 00000213 5D                              	POP	EBP
   261 00000214 E9 FFFFFEE8                     	JMP	_memman_free
